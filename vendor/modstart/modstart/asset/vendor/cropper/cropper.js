!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],e):e(t.jQuery)}(this,function(k){"use strict";k="default"in k?k.default:k;var a={viewMode:0,dragMode:"crop",aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},n=/^data:.*,/,t="undefined"!=typeof window?window.navigator:null,p=t&&/(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(t.userAgent),l=String.fromCharCode;function w(t){return"number"==typeof t&&!isNaN(t)}function r(t){return void 0===t}function o(r,h){for(var t=arguments.length,s=Array(2<t?t-2:0),e=2;e<t;e++)s[e-2]=arguments[e];return function(){for(var t,e,i,a=arguments.length,o=Array(a),n=0;n<a;n++)o[n]=arguments[n];return r.apply(h,s.concat((t=o,i=[],w(e)&&i.push(e),i.slice.apply(t,i))))}}function T(t){var e=[];return k.each(t,function(t){e.push(t)}),e}function h(t){t=t.match(/^(https?:)\/\/([^:/?#]+):?(\d*)/i);return t&&(t[1]!==location.protocol||t[2]!==location.hostname||t[3]!==location.port)}function s(t){var e="timestamp="+(new Date).getTime();return t+(-1===t.indexOf("?")?"?":"&")+e}function g(t){var e=[],i=t.translateX,a=t.translateY,o=t.rotate,n=t.scaleX,t=t.scaleY;return w(i)&&0!==i&&e.push("translateX("+i+"px)"),w(a)&&0!==a&&e.push("translateY("+a+"px)"),w(o)&&0!==o&&e.push("rotate("+o+"deg)"),w(n)&&1!==n&&e.push("scaleX("+n+")"),w(t)&&1!==t&&e.push("scaleY("+t+")"),e.length?e.join(" "):"none"}function x(t,e){var i=Math.abs(t.degree)%180,a=(90<i?180-i:i)*Math.PI/180,o=Math.sin(a),n=Math.cos(a),r=t.width,h=t.height,i=t.aspectRatio,a=void 0,t=void 0,t=e?(a=r/(n+o/i))/i:(a=r*n+h*o,r*o+h*n);return{width:a,height:t}}function f(t,e){var i=k("<canvas>")[0],a=i.getContext("2d"),o=0,n=0,r=e.naturalWidth,h=e.naturalHeight,s=e.rotate,d=e.scaleX,c=e.scaleY,p=w(d)&&w(c)&&(1!==d||1!==c),l=w(s)&&0!==s,m=l||p,g=r*Math.abs(d||1),u=h*Math.abs(c||1),f=void 0,v=void 0,e=void 0;return p&&(f=g/2,v=u/2),l&&(f=(g=(e=x({width:g,height:u,degree:s})).width)/2,v=(u=e.height)/2),i.width=g,i.height=u,m&&(o=-r/2,n=-h/2,a.save(),a.translate(f,v)),l&&a.rotate(s*Math.PI/180),p&&a.scale(d,c),a.drawImage(t,Math.floor(o),Math.floor(n),Math.floor(r),Math.floor(h)),m&&a.restore(),i}function d(t){var e,i,a=new DataView(t),o=a.byteLength,n=void 0,r=void 0,t=void 0,h=void 0,s=void 0,d=void 0,c=void 0;if(255===a.getUint8(0)&&216===a.getUint8(1))for(d=2;d<o;){if(255===a.getUint8(d)&&225===a.getUint8(d+1)){h=d;break}d++}if(h&&(e=h+10,"Exif"===function(t,e,i){var a="",o=void 0,o=e;for(i+=e;o<i;o++)a+=l(t.getUint8(o));return a}(a,h+4,4)&&((r=18761===(t=a.getUint16(e)))||19789===t)&&42===a.getUint16(e+2,r)&&8<=(i=a.getUint32(e+4,r))&&(s=e+i)),s)for(o=a.getUint16(s,r),c=0;c<o;c++)if(274===a.getUint16(d=s+12*c+2,r)){d+=8,n=a.getUint16(d,r),p&&a.setUint16(d,1,r);break}return n}var e={render:function(){var t=this;t.initContainer(),t.initCanvas(),t.initCropBox(),t.renderCanvas(),t.cropped&&t.renderCropBox()},initContainer:function(){var t=this,e=t.options,i=t.$element,a=t.$container,o=t.$cropper,n="cropper-hidden";o.addClass(n),i.removeClass(n),o.css(t.container={width:Math.max(a.width(),Number(e.minContainerWidth)||200),height:Math.max(a.height(),Number(e.minContainerHeight)||100)}),i.addClass(n),o.removeClass(n)},initCanvas:function(){var t=this,e=t.options.viewMode,i=t.container,a=i.width,o=i.height,n=t.image,r=n.naturalWidth,h=n.naturalHeight,s=Math.abs(n.rotate)%180==90,d=s?h:r,i=s?r:h,s=d/i,r=a,h=o;a<o*s?3===e?r=o*s:h=a/s:3===e?h=a/s:r=o*s;s={naturalWidth:d,naturalHeight:i,aspectRatio:s,width:r,height:h};s.oldLeft=s.left=(a-r)/2,s.oldTop=s.top=(o-h)/2,t.canvas=s,t.limited=1===e||2===e,t.limitCanvas(!0,!0),t.initialImage=k.extend({},n),t.initialCanvas=k.extend({},s)},limitCanvas:function(t,e){var i,a=this,o=a.options,n=o.viewMode,r=a.container,h=r.width,s=r.height,d=a.canvas,c=d.aspectRatio,p=a.cropBox,r=a.cropped&&p;t&&(t=Number(o.minCanvasWidth)||0,i=Number(o.minCanvasHeight)||0,n&&(1<n?(t=Math.max(t,h),i=Math.max(i,s),3===n&&(t<i*c?t=i*c:i=t/c)):t?t=Math.max(t,r?p.width:0):i?i=Math.max(i,r?p.height:0):r&&((t=p.width)<(i=p.height)*c?t=i*c:i=t/c)),t&&i?t<i*c?i=t/c:t=i*c:t?i=t/c:i&&(t=i*c),d.minWidth=t,d.minHeight=i,d.maxWidth=1/0,d.maxHeight=1/0),e&&(n?(i=h-d.width,e=s-d.height,d.minLeft=Math.min(0,i),d.minTop=Math.min(0,e),d.maxLeft=Math.max(0,i),d.maxTop=Math.max(0,e),r&&a.limited&&(d.minLeft=Math.min(p.left,p.left+p.width-d.width),d.minTop=Math.min(p.top,p.top+p.height-d.height),d.maxLeft=p.left,d.maxTop=p.top,2===n&&(d.width>=h&&(d.minLeft=Math.min(0,i),d.maxLeft=Math.max(0,i)),d.height>=s&&(d.minTop=Math.min(0,e),d.maxTop=Math.max(0,e))))):(d.minLeft=-d.width,d.minTop=-d.height,d.maxLeft=h,d.maxTop=s))},renderCanvas:function(t){var e,i,a=this,o=a.canvas,n=a.image,r=n.rotate,h=n.naturalWidth,s=n.naturalHeight;a.rotated&&(a.rotated=!1,i=(e=x({width:n.width,height:n.height,degree:r})).width/e.height,!(n=1===n.aspectRatio)&&i===o.aspectRatio||(o.left-=(e.width-o.width)/2,o.top-=(e.height-o.height)/2,o.width=e.width,o.height=e.height,o.aspectRatio=i,o.naturalWidth=h,o.naturalHeight=s,(n&&r%90||r%180)&&(r=x({width:h,height:s,degree:r}),o.naturalWidth=r.width,o.naturalHeight=r.height),a.limitCanvas(!0,!1))),(o.width>o.maxWidth||o.width<o.minWidth)&&(o.left=o.oldLeft),(o.height>o.maxHeight||o.height<o.minHeight)&&(o.top=o.oldTop),o.width=Math.min(Math.max(o.width,o.minWidth),o.maxWidth),o.height=Math.min(Math.max(o.height,o.minHeight),o.maxHeight),a.limitCanvas(!1,!0),o.oldLeft=o.left=Math.min(Math.max(o.left,o.minLeft),o.maxLeft),o.oldTop=o.top=Math.min(Math.max(o.top,o.minTop),o.maxTop),a.$canvas.css({width:o.width,height:o.height,transform:g({translateX:o.left,translateY:o.top})}),a.renderImage(),a.cropped&&a.limited&&a.limitCropBox(!0,!0),t&&a.output()},renderImage:function(t){var e=this.canvas,i=this.image,a=void 0;i.rotate&&(a=x({width:e.width,height:e.height,degree:i.rotate,aspectRatio:i.aspectRatio},!0)),k.extend(i,a?{width:a.width,height:a.height,left:(e.width-a.width)/2,top:(e.height-a.height)/2}:{width:e.width,height:e.height,left:0,top:0}),this.$clone.css({width:i.width,height:i.height,transform:g(k.extend({translateX:i.left,translateY:i.top},i))}),t&&this.output()},initCropBox:function(){var t=this,e=t.options,i=t.canvas,a=e.aspectRatio,o=Number(e.autoCropArea)||.8,e={width:i.width,height:i.height};a&&(i.height*a>i.width?e.height=e.width/a:e.width=e.height*a),t.cropBox=e,t.limitCropBox(!0,!0),e.width=Math.min(Math.max(e.width,e.minWidth),e.maxWidth),e.height=Math.min(Math.max(e.height,e.minHeight),e.maxHeight),e.width=Math.max(e.minWidth,e.width*o),e.height=Math.max(e.minHeight,e.height*o),e.oldLeft=e.left=i.left+(i.width-e.width)/2,e.oldTop=e.top=i.top+(i.height-e.height)/2,t.initialCropBox=k.extend({},e)},limitCropBox:function(t,e){var i=this,a=i.options,o=a.aspectRatio,n=i.container,r=n.width,h=n.height,s=i.canvas,d=i.cropBox,c=i.limited;t&&(n=Number(a.minCropBoxWidth)||0,i=Number(a.minCropBoxHeight)||0,t=Math.min(r,c?s.width:r),a=Math.min(h,c?s.height:h),n=Math.min(n,r),i=Math.min(i,h),o&&(n&&i?n<i*o?i=n/o:n=i*o:n?i=n/o:i&&(n=i*o),t<a*o?a=t/o:t=a*o),d.minWidth=Math.min(n,t),d.minHeight=Math.min(i,a),d.maxWidth=t,d.maxHeight=a),e&&(c?(d.minLeft=Math.max(0,s.left),d.minTop=Math.max(0,s.top),d.maxLeft=Math.min(r,s.left+s.width)-d.width,d.maxTop=Math.min(h,s.top+s.height)-d.height):(d.minLeft=0,d.minTop=0,d.maxLeft=r-d.width,d.maxTop=h-d.height))},renderCropBox:function(){var t=this,e=t.options,i=t.container,a=i.width,o=i.height,i=t.cropBox;(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),t.limitCropBox(!1,!0),i.oldLeft=i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.oldTop=i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),e.movable&&e.cropBoxMovable&&t.$face.data("action",i.width===a&&i.height===o?"move":"all"),t.$cropBox.css({width:i.width,height:i.height,transform:g({translateX:i.left,translateY:i.top})}),t.cropped&&t.limited&&t.limitCanvas(!0,!0),t.disabled||t.output()},output:function(){this.preview(),this.completed&&this.trigger("crop",this.getData())}},u="preview",i={initPreview:function(){var t=this,a=t.crossOrigin,o=a?t.crossOriginUrl:t.url,e=document.createElement("img");a&&(e.crossOrigin=a),e.src=o;e=k(e);t.$preview=k(t.options.preview),t.$clone2=e,t.$viewBox.html(e),t.$preview.each(function(t,e){var i=k(e),e=document.createElement("img");i.data(u,{width:i.width(),height:i.height(),html:i.html()}),a&&(e.crossOrigin=a),e.src=o,e.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',i.html(e)})},resetPreview:function(){this.$preview.each(function(t,e){var i=k(e),e=i.data(u);i.css({width:e.width,height:e.height}).html(e.html).removeData(u)})},preview:function(){var t=this,h=t.image,e=t.canvas,i=t.cropBox,s=i.width,d=i.height,c=h.width,p=h.height,l=i.left-e.left-h.left,m=i.top-e.top-h.top;t.cropped&&!t.disabled&&(t.$clone2.css({width:c,height:p,transform:g(k.extend({translateX:-l,translateY:-m},h))}),t.$preview.each(function(t,e){var i=k(e),a=i.data(u),o=a.width,n=a.height,r=o,e=n,a=1;s&&(e=d*(a=o/s)),d&&n<e&&(r=s*(a=n/d),e=n),i.css({width:r,height:e}).find("img").css({width:c*a,height:p*a,transform:g(k.extend({translateX:-l*a,translateY:-m*a},h))})}))}},c="undefined"!=typeof window?window.PointerEvent:null,m=c?"pointerdown":"touchstart mousedown",v=c?"pointermove":"touchmove mousemove",b=c?" pointerup pointercancel":"touchend touchcancel mouseup",y="wheel mousewheel DOMMouseScroll",C="dblclick",M="resize",$="cropstart",B="cropmove",D="cropend",X="crop",Y="zoom",W={bind:function(){var t=this,e=t.options,i=t.$element,a=t.$cropper;k.isFunction(e.cropstart)&&i.on($,e.cropstart),k.isFunction(e.cropmove)&&i.on(B,e.cropmove),k.isFunction(e.cropend)&&i.on(D,e.cropend),k.isFunction(e.crop)&&i.on(X,e.crop),k.isFunction(e.zoom)&&i.on(Y,e.zoom),a.on(m,o(t.cropStart,this)),e.zoomable&&e.zoomOnWheel&&a.on(y,o(t.wheel,this)),e.toggleDragModeOnDblclick&&a.on(C,o(t.dblclick,this)),k(document).on(v,t.onCropMove=o(t.cropMove,this)).on(b,t.onCropEnd=o(t.cropEnd,this)),e.responsive&&k(window).on(M,t.onResize=o(t.resize,this))},unbind:function(){var t=this,e=t.options,i=t.$element,a=t.$cropper;k.isFunction(e.cropstart)&&i.off($,e.cropstart),k.isFunction(e.cropmove)&&i.off(B,e.cropmove),k.isFunction(e.cropend)&&i.off(D,e.cropend),k.isFunction(e.crop)&&i.off(X,e.crop),k.isFunction(e.zoom)&&i.off(Y,e.zoom),a.off(m,t.cropStart),e.zoomable&&e.zoomOnWheel&&a.off(y,t.wheel),e.toggleDragModeOnDblclick&&a.off(C,t.dblclick),k(document).off(v,t.onCropMove).off(b,t.onCropEnd),e.responsive&&k(window).off(M,t.onResize)}},H=/^(e|w|s|n|se|sw|ne|nw|all|crop|move|zoom)$/;function O(t,e){var i=t.pageX,a=t.pageY,t={endX:i,endY:a};return e?t:k.extend({startX:i,startY:a},t)}var z={resize:function(){var i,a,o,t=this,e=t.options,n=t.$container,r=t.container,h=Number(e.minContainerWidth)||200,s=Number(e.minContainerHeight)||100;t.disabled||r.width===h||r.height===s||(1==(i=n.width()/r.width)&&n.height()===r.height||(o=a=void 0,e.restore&&(a=t.getCanvasData(),o=t.getCropBoxData()),t.render(),e.restore&&(t.setCanvasData(k.each(a,function(t,e){a[t]=e*i})),t.setCropBoxData(k.each(o,function(t,e){o[t]=e*i})))))},dblclick:function(){this.disabled||"none"===this.options.dragMode||this.setDragMode(this.$dragBox.hasClass("cropper-crop")?"move":"crop")},wheel:function(t){var e,i=this,a=t.originalEvent||t,o=Number(i.options.wheelZoomRatio)||.1;i.disabled||(t.preventDefault(),i.wheeling||(i.wheeling=!0,setTimeout(function(){i.wheeling=!1},50),e=1,a.deltaY?e=0<a.deltaY?1:-1:a.wheelDelta?e=-a.wheelDelta/120:a.detail&&(e=0<a.detail?1:-1),i.zoom(-e*o,t)))},cropStart:function(t){var e,i,a,o,n=this;n.disabled||(e=n.options,i=n.pointers,o=void 0,(a=t.originalEvent)&&a.changedTouches?k.each(a.changedTouches,function(t,e){i[e.identifier]=O(e)}):i[a&&a.pointerId||0]=O(a||t),o=1<T(i).length&&e.zoomable&&e.zoomOnTouch?"zoom":k(t.target).data("action"),H.test(o)&&(n.trigger("cropstart",{originalEvent:a,action:o}).isDefaultPrevented()||(t.preventDefault(),n.action=o,n.cropping=!1,"crop"===o&&(n.cropping=!0,n.$dragBox.addClass("cropper-modal")))))},cropMove:function(t){var i,e,a=this,o=a.action;!a.disabled&&o&&(i=a.pointers,e=t.originalEvent,t.preventDefault(),a.trigger("cropmove",{originalEvent:e,action:o}).isDefaultPrevented()||(e&&e.changedTouches?k.each(e.changedTouches,function(t,e){k.extend(i[e.identifier],O(e,!0))}):k.extend(i[e&&e.pointerId||0],O(e||t,!0)),a.change(t)))},cropEnd:function(t){var e,i,a,o=this;o.disabled||(e=o.action,i=o.pointers,(a=t.originalEvent)&&a.changedTouches?k.each(a.changedTouches,function(t,e){delete i[e.identifier]}):delete i[a&&a.pointerId||0],e&&(t.preventDefault(),T(i).length||(o.action=""),o.cropping&&(o.cropping=!1,o.$dragBox.toggleClass("cropper-modal",o.cropped&&o.options.modal)),o.trigger("cropend",{originalEvent:a,action:e})))}},R="se",L="sw",N="ne",E="nw";var t={change:function(t){var e,i=this,a=i.options,o=i.pointers,n=o[T(o)[0]],r=i.container,h=i.canvas,s=i.cropBox,d=i.action,c=a.aspectRatio,p=s.width,l=s.height,m=s.left,g=s.top,u=m+p,f=g+l,v=0,w=0,x=r.width,b=r.height,y=!0;!c&&t.shiftKey&&(c=p&&l?p/l:1),i.limited&&(v=s.minLeft,w=s.minTop,x=v+Math.min(r.width,h.width,h.left+h.width),b=w+Math.min(r.height,h.height,h.top+h.height));var C,M,$,B={x:n.endX-n.startX,y:n.endY-n.startY};switch(c&&(B.X=B.y*c,B.Y=B.x/c),d){case"all":m+=B.x,g+=B.y;break;case"e":if(0<=B.x&&(x<=u||c&&(g<=w||b<=f))){y=!1;break}p+=B.x,c&&(l=p/c,g-=B.Y/2),p<0&&(d="w",p=0);break;case"n":if(B.y<=0&&(g<=w||c&&(m<=v||x<=u))){y=!1;break}l-=B.y,g+=B.y,c&&(p=l*c,m+=B.X/2),l<0&&(d="s",l=0);break;case"w":if(B.x<=0&&(m<=v||c&&(g<=w||b<=f))){y=!1;break}p-=B.x,m+=B.x,c&&(l=p/c,g+=B.Y/2),p<0&&(d="e",p=0);break;case"s":if(0<=B.y&&(b<=f||c&&(m<=v||x<=u))){y=!1;break}l+=B.y,c&&(p=l*c,m-=B.X/2),l<0&&(d="n",l=0);break;case N:if(c){if(B.y<=0&&(g<=w||x<=u)){y=!1;break}l-=B.y,g+=B.y,p=l*c}else!(0<=B.x)||u<x?p+=B.x:B.y<=0&&g<=w&&(y=!1),B.y<=0&&!(w<g)||(l-=B.y,g+=B.y);p<0&&l<0?(d=L,p=l=0):p<0?(d=E,p=0):l<0&&(d=R,l=0);break;case E:if(c){if(B.y<=0&&(g<=w||m<=v)){y=!1;break}l-=B.y,g+=B.y,p=l*c,m+=B.X}else!(B.x<=0)||v<m?(p-=B.x,m+=B.x):B.y<=0&&g<=w&&(y=!1),B.y<=0&&!(w<g)||(l-=B.y,g+=B.y);p<0&&l<0?(d=R,p=l=0):p<0?(d=N,p=0):l<0&&(d=L,l=0);break;case L:if(c){if(B.x<=0&&(m<=v||b<=f)){y=!1;break}p-=B.x,m+=B.x,l=p/c}else!(B.x<=0)||v<m?(p-=B.x,m+=B.x):0<=B.y&&b<=f&&(y=!1),0<=B.y&&!(f<b)||(l+=B.y);p<0&&l<0?(d=N,p=l=0):p<0?(d=R,p=0):l<0&&(d=E,l=0);break;case R:if(c){if(0<=B.x&&(x<=u||b<=f)){y=!1;break}l=(p+=B.x)/c}else!(0<=B.x)||u<x?p+=B.x:0<=B.y&&b<=f&&(y=!1),0<=B.y&&!(f<b)||(l+=B.y);p<0&&l<0?(d=E,p=l=0):p<0?(d=L,p=0):l<0&&(d=N,l=0);break;case"move":i.move(B.x,B.y),y=!1;break;case"zoom":i.zoom((C=o,M=k.extend({},C),$=[],k.each(C,function(t,n){delete M[t],k.each(M,function(t,e){var i=Math.abs(n.startX-e.startX),a=Math.abs(n.startY-e.startY),o=Math.abs(n.endX-e.endX),e=Math.abs(n.endY-e.endY),a=Math.sqrt(i*i+a*a),e=Math.sqrt(o*o+e*e);$.push((e-a)/a)})}),$.sort(function(t,e){return Math.abs(t)<Math.abs(e)}),$[0]),t.originalEvent),y=!1;break;case"crop":if(!B.x||!B.y){y=!1;break}e=i.$cropper.offset(),m=n.startX-e.left,g=n.startY-e.top,p=s.minWidth,l=s.minHeight,0<B.x?d=0<B.y?R:N:B.x<0&&(m-=p,d=0<B.y?L:E),B.y<0&&(g-=l),i.cropped||(i.$cropBox.removeClass("cropper-hidden"),i.cropped=!0,i.limited&&i.limitCropBox(!0,!0))}y&&(s.width=p,s.height=l,s.left=m,s.top=g,i.action=d,i.renderCropBox()),k.each(o,function(t,e){e.startX=e.endX,e.startY=e.endY})}},I=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};function P(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var c={crop:function(){var t=this;t.ready&&!t.disabled&&(t.cropped||(t.cropped=!0,t.limitCropBox(!0,!0),t.options.modal&&t.$dragBox.addClass("cropper-modal"),t.$cropBox.removeClass("cropper-hidden")),t.setCropBoxData(t.initialCropBox))},reset:function(){var t=this;t.ready&&!t.disabled&&(t.image=k.extend({},t.initialImage),t.canvas=k.extend({},t.initialCanvas),t.cropBox=k.extend({},t.initialCropBox),t.renderCanvas(),t.cropped&&t.renderCropBox())},clear:function(){var t=this;t.cropped&&!t.disabled&&(k.extend(t.cropBox,{left:0,top:0,width:0,height:0}),t.cropped=!1,t.renderCropBox(),t.limitCanvas(!0,!0),t.renderCanvas(),t.$dragBox.removeClass("cropper-modal"),t.$cropBox.addClass("cropper-hidden"))},replace:function(t,e){var i=this;!i.disabled&&t&&(i.isImg&&i.$element.attr("src",t),e?(i.url=t,i.$clone.attr("src",t),i.ready&&i.$preview.find("img").add(i.$clone2).attr("src",t)):(i.isImg&&(i.replaced=!0),i.options.data=null,i.load(t)))},enable:function(){this.ready&&(this.disabled=!1,this.$cropper.removeClass("cropper-disabled"))},disable:function(){this.ready&&(this.disabled=!0,this.$cropper.addClass("cropper-disabled"))},destroy:function(){var t=this,e=t.$element;t.loaded?(t.isImg&&t.replaced&&e.attr("src",t.originalUrl),t.unbuild(),e.removeClass("cropper-hidden")):t.isImg?e.off("load",t.start):t.$clone&&t.$clone.remove(),e.removeData("cropper")},move:function(t,e){var i=this.canvas;this.moveTo(r(t)?t:i.left+Number(t),r(e)?e:i.top+Number(e))},moveTo:function(t,e){var i=this,a=i.canvas,o=!1;r(e)&&(e=t),t=Number(t),e=Number(e),i.ready&&!i.disabled&&i.options.movable&&(w(t)&&(a.left=t,o=!0),w(e)&&(a.top=e,o=!0),o&&i.renderCanvas(!0))},zoom:function(t,e){var i=this.canvas;t=Number(t),this.zoomTo(i.width*(t=t<0?1/(1-t):1+t)/i.naturalWidth,e)},zoomTo:function(t,e){var a,o,n,i=this,r=i.options,h=i.pointers,s=i.canvas,d=s.width,c=s.height,p=s.naturalWidth,l=s.naturalHeight;0<=(t=Number(t))&&i.ready&&!i.disabled&&r.zoomable&&(r=l*t,l=void 0,e&&(l=e.originalEvent),i.trigger("zoom",{originalEvent:l,oldRatio:d/p,ratio:(t=p*t)/p}).isDefaultPrevented()||(l?(p=i.$cropper.offset(),l=h&&T(h).length?(n=o=a=0,k.each(h,function(t,e){var i=e.startX,e=e.startY;a+=i,o+=e,n+=1}),{pageX:a/=n,pageY:o/=n}):{pageX:e.pageX||l.pageX||0,pageY:e.pageY||l.pageY||0},s.left-=(t-d)*((l.pageX-p.left-s.left)/d),s.top-=(r-c)*((l.pageY-p.top-s.top)/c)):(s.left-=(t-d)/2,s.top-=(r-c)/2),s.width=t,s.height=r,i.renderCanvas(!0)))},rotate:function(t){this.rotateTo((this.image.rotate||0)+Number(t))},rotateTo:function(t){var e=this;w(t=Number(t))&&e.ready&&!e.disabled&&e.options.rotatable&&(e.image.rotate=t%360,e.rotated=!0,e.renderCanvas(!0))},scale:function(t,e){var i=this,a=i.image,o=!1;r(e)&&(e=t),t=Number(t),e=Number(e),i.ready&&!i.disabled&&i.options.scalable&&(w(t)&&(a.scaleX=t,o=!0),w(e)&&(a.scaleY=e,o=!0),o&&i.renderImage(!0))},scaleX:function(t){var e=this.image.scaleY;this.scale(t,w(e)?e:1)},scaleY:function(t){var e=this.image.scaleX;this.scale(w(e)?e:1,t)},getData:function(i){var a,t=this,e=t.options,o=t.image,n=t.canvas,r=t.cropBox,h=void 0;return t.ready&&t.cropped?(h={x:r.left-n.left,y:r.top-n.top,width:r.width,height:r.height},a=o.width/o.naturalWidth,k.each(h,function(t,e){e/=a,h[t]=i?Math.round(e):e})):h={x:0,y:0,width:0,height:0},e.rotatable&&(h.rotate=o.rotate||0),e.scalable&&(h.scaleX=o.scaleX||1,h.scaleY=o.scaleY||1),h},setData:function(t){var e,i=this,a=i.options,o=i.image,n=i.canvas,r={},h=void 0,s=void 0;k.isFunction(t)&&(t=t.call(i.element)),i.ready&&!i.disabled&&k.isPlainObject(t)&&(a.rotatable&&w(t.rotate)&&t.rotate!==o.rotate&&(o.rotate=t.rotate,i.rotated=h=!0),a.scalable&&(w(t.scaleX)&&t.scaleX!==o.scaleX&&(o.scaleX=t.scaleX,s=!0),w(t.scaleY)&&t.scaleY!==o.scaleY&&(o.scaleY=t.scaleY,s=!0)),h?i.renderCanvas():s&&i.renderImage(),e=o.width/o.naturalWidth,w(t.x)&&(r.left=t.x*e+n.left),w(t.y)&&(r.top=t.y*e+n.top),w(t.width)&&(r.width=t.width*e),w(t.height)&&(r.height=t.height*e),i.setCropBoxData(r))},getContainerData:function(){return this.ready?this.container:{}},getImageData:function(){return this.loaded?this.image:{}},getCanvasData:function(){var i=this.canvas,a={};return this.ready&&k.each(["left","top","width","height","naturalWidth","naturalHeight"],function(t,e){a[e]=i[e]}),a},setCanvasData:function(t){var e=this,i=e.canvas,a=i.aspectRatio;k.isFunction(t)&&(t=t.call(e.$element)),e.ready&&!e.disabled&&k.isPlainObject(t)&&(w(t.left)&&(i.left=t.left),w(t.top)&&(i.top=t.top),w(t.width)?(i.width=t.width,i.height=t.width/a):w(t.height)&&(i.height=t.height,i.width=t.height*a),e.renderCanvas(!0))},getCropBoxData:function(){var t=this.cropBox;return this.ready&&this.cropped?{left:t.left,top:t.top,width:t.width,height:t.height}:{}},setCropBoxData:function(t){var e=this,i=e.cropBox,a=e.options.aspectRatio,o=void 0,n=void 0;k.isFunction(t)&&(t=t.call(e.$element)),e.ready&&e.cropped&&!e.disabled&&k.isPlainObject(t)&&(w(t.left)&&(i.left=t.left),w(t.top)&&(i.top=t.top),w(t.width)&&t.width!==i.width&&(o=!0,i.width=t.width),w(t.height)&&t.height!==i.height&&(n=!0,i.height=t.height),a&&(o?i.height=i.width/a:n&&(i.width=i.height*a)),e.renderCropBox())},getCroppedCanvas:function(t){var e=this;if(!e.ready||!window.HTMLCanvasElement)return null;if(!e.cropped)return f(e.$clone[0],e.image);k.isPlainObject(t)||(t={});var i=e.getData(),a=i.width,o=i.height,n=a/o,r=void 0,h=void 0,s=void 0;k.isPlainObject(t)&&(r=t.width,h=t.height,r?(h=r/n,s=r/a):h&&(r=h*n,s=h/o));var d=Math.floor(r||a),c=Math.floor(h||o),p=k("<canvas>")[0],l=p.getContext("2d");p.width=d,p.height=c,t.fillColor&&(l.fillStyle=t.fillColor,l.fillRect(0,0,d,c));var m,g,u,r=(m=f(e.$clone[0],e.image),g=m.width,u=m.height,n=e.canvas,r=[m],h=i.x+n.naturalWidth*(Math.abs(i.scaleX||1)-1)/2,t=i.y+n.naturalHeight*(Math.abs(i.scaleY||1)-1)/2,n=m=i=e=c=d=void 0,h<=-a||g<h?h=d=e=m=0:h<=0?(e=-h,h=0,d=m=Math.min(g,a+h)):h<=g&&(e=0,d=m=Math.min(a,g-h)),d<=0||t<=-o||u<t?t=c=i=n=0:t<=0?(i=-t,t=0,c=n=Math.min(u,o+t)):t<=u&&(i=0,c=n=Math.min(o,u-t)),r.push(Math.floor(h),Math.floor(t),Math.floor(d),Math.floor(c)),s&&(e*=s,i*=s,m*=s,n*=s),0<m&&0<n&&r.push(Math.floor(e),Math.floor(i),Math.floor(m),Math.floor(n)),r);return l.drawImage.apply(l,function(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}(r)),p},setAspectRatio:function(t){var e=this,i=e.options;e.disabled||r(t)||(i.aspectRatio=Math.max(0,t)||NaN,e.ready&&(e.initCropBox(),e.cropped&&e.renderCropBox()))},setDragMode:function(t){var e,i,a=this,o=a.options;a.loaded&&!a.disabled&&(i=o.movable&&"move"===t,a.$dragBox.data("action",t=(e="crop"===t)||i?t:"none").toggleClass("cropper-crop",e).toggleClass("cropper-move",i),o.cropBoxMovable||a.$face.data("action",t).toggleClass("cropper-crop",e).toggleClass("cropper-move",i))}},U="cropper-hidden",A=/^data:/,j=/^data:image\/jpeg;base64,/,F=(function(t,e,i){return e&&P(t.prototype,e),i&&P(t,i),t}(q,[{key:"init",value:function(){var t=this.$element,e=void 0;if(t.is("img")){if(this.isImg=!0,this.originalUrl=e=t.attr("src"),!e)return;e=t.prop("src")}else t.is("canvas")&&window.HTMLCanvasElement&&(e=t[0].toDataURL());this.load(e)}},{key:"trigger",value:function(t,e){e=k.Event(t,e);return this.$element.trigger(e),e}},{key:"load",value:function(t){var e,i=this,a=i.options,o=i.$element;t&&(i.url=t,i.image={},a.checkOrientation&&window.ArrayBuffer?A.test(t)?j.test(t)?i.read(function(t){for(var t=t.replace(n,""),e=atob(t),i=e.length,t=new ArrayBuffer(i),a=new Uint8Array(t),o=void 0,o=0;o<i;o++)a[o]=e.charCodeAt(o);return t}(t)):i.clone():((e=new XMLHttpRequest).onerror=e.onabort=k.proxy(function(){i.clone()},this),e.onload=function(){i.read(this.response)},a.checkCrossOrigin&&h(t)&&o.prop("crossOrigin")&&(t=s(t)),e.open("get",t),e.responseType="arraybuffer",e.withCredentials="use-credentials"===o.prop("crossOrigin"),e.send()):i.clone())}},{key:"read",value:function(t){var e=this.options,i=d(t),a=this.image,o=0,n=1,r=1;if(1<i)switch(this.url=function(t){for(var e=new Uint8Array(t),i=e.length,a="",o=void 0,o=0;o<i;o++)a+=l(e[o]);return"data:image/jpeg;base64,"+btoa(a)}(t),i){case 2:n=-1;break;case 3:o=-180;break;case 4:r=-1;break;case 5:o=90,r=-1;break;case 6:o=90;break;case 7:o=90,n=-1;break;case 8:o=-90}e.rotatable&&(a.rotate=o),e.scalable&&(a.scaleX=n,a.scaleY=r),this.clone()}},{key:"clone",value:function(){var t=this,e=t.options,i=t.$element,a=t.url,o="",n=void 0;e.checkCrossOrigin&&h(a)&&(n=(o=i.prop("crossOrigin"))?a:(o="anonymous",s(a))),t.crossOrigin=o,t.crossOriginUrl=n;e=document.createElement("img");o&&(e.crossOrigin=o),e.src=n||a;e=k(e);t.$clone=e,t.isImg?i[0].complete?t.start():i.one("load",k.proxy(t.start,this)):e.one("load",k.proxy(t.start,this)).one("error",k.proxy(t.stop,this)).addClass("cropper-hide").insertAfter(i)}},{key:"start",value:function(){var t,i=this,e=i.$clone,a=i.$element;i.isImg||(e.off("error",i.stop),a=e),e=a[0],t=function(t,e){k.extend(i.image,{naturalWidth:t,naturalHeight:e,aspectRatio:t/e}),i.loaded=!0,i.build()},!e.naturalWidth||p?((a=document.createElement("img")).onload=function(){t(this.width,this.height)},a.src=e.src):t(e.naturalWidth,e.naturalHeight)}},{key:"stop",value:function(){this.$clone.remove(),this.$clone=null}},{key:"build",value:function(){var t=this,e=t.options,i=t.$element,a=t.$clone,o=void 0,n=void 0,r=void 0;t.loaded&&(t.ready&&t.unbuild(),t.$container=i.parent(),t.$cropper=o=k('<div class="cropper-container"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-action="e"></span><span class="cropper-line line-n" data-action="n"></span><span class="cropper-line line-w" data-action="w"></span><span class="cropper-line line-s" data-action="s"></span><span class="cropper-point point-e" data-action="e"></span><span class="cropper-point point-n" data-action="n"></span><span class="cropper-point point-w" data-action="w"></span><span class="cropper-point point-s" data-action="s"></span><span class="cropper-point point-ne" data-action="ne"></span><span class="cropper-point point-nw" data-action="nw"></span><span class="cropper-point point-sw" data-action="sw"></span><span class="cropper-point point-se" data-action="se"></span></div></div>'),t.$canvas=o.find(".cropper-canvas").append(a),t.$dragBox=o.find(".cropper-drag-box"),t.$cropBox=n=o.find(".cropper-crop-box"),t.$viewBox=o.find(".cropper-view-box"),t.$face=r=n.find(".cropper-face"),i.addClass(U).after(o),t.isImg||a.removeClass("cropper-hide"),t.initPreview(),t.bind(),e.aspectRatio=Math.max(0,e.aspectRatio)||NaN,e.viewMode=Math.max(0,Math.min(3,Math.round(e.viewMode)))||0,t.cropped=e.autoCrop,e.autoCrop?e.modal&&t.$dragBox.addClass("cropper-modal"):n.addClass(U),e.guides||n.find(".cropper-dashed").addClass(U),e.center||n.find(".cropper-center").addClass(U),e.cropBoxMovable&&r.addClass("cropper-move").data("action","all"),e.highlight||r.addClass("cropper-invisible"),e.background&&o.addClass("cropper-bg"),e.cropBoxResizable||n.find(".cropper-line, .cropper-point").addClass(U),t.setDragMode(e.dragMode),t.render(),t.ready=!0,t.setData(e.data),t.completing=setTimeout(function(){k.isFunction(e.ready)&&i.one("ready",e.ready),t.trigger("ready"),t.trigger("crop",t.getData()),t.completed=!0},0))}},{key:"unbuild",value:function(){var t=this;t.ready&&(t.completed||clearTimeout(t.completing),t.ready=!1,t.completed=!1,t.initialImage=null,t.initialCanvas=null,t.initialCropBox=null,t.container=null,t.canvas=null,t.cropBox=null,t.unbind(),t.resetPreview(),t.$preview=null,t.$viewBox=null,t.$cropBox=null,t.$dragBox=null,t.$canvas=null,t.$container=null,t.$cropper.remove(),t.$cropper=null)}}],[{key:"setDefaults",value:function(t){k.extend(a,k.isPlainObject(t)&&t)}}]),q);function q(t,e){I(this,q);var i=this;i.$element=k(t),i.options=k.extend({},a,k.isPlainObject(e)&&e),i.loaded=!1,i.ready=!1,i.completed=!1,i.rotated=!1,i.cropped=!1,i.disabled=!1,i.replaced=!1,i.limited=!1,i.wheeling=!1,i.isImg=!1,i.originalUrl="",i.canvas=null,i.cropBox=null,i.pointers={},i.init()}k.extend(F.prototype,e),k.extend(F.prototype,i),k.extend(F.prototype,W),k.extend(F.prototype,z),k.extend(F.prototype,t),k.extend(F.prototype,c);var S="cropper",K=k.fn.cropper;k.fn.cropper=function(n){for(var t=arguments.length,r=Array(1<t?t-1:0),e=1;e<t;e++)r[e-1]=arguments[e];var h=void 0;return this.each(function(t,e){var i=k(e),a=i.data(S);if(!a){if(/destroy/.test(n))return;var o=k.extend({},i.data(),k.isPlainObject(n)&&n);i.data(S,a=new F(e,o))}"string"==typeof n&&(o=a[n],k.isFunction(o)&&(h=o.apply(a,r)))}),void 0!==h?h:this},k.fn.cropper.Constructor=F,k.fn.cropper.setDefaults=F.setDefaults,k.fn.cropper.noConflict=function(){return k.fn.cropper=K,this}});